<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body>

    <div class="mt-3 mb-3">
        <form class="form-inline"  method="POST" action="#">
            {% csrf_token %}
            <div class="row">
                <div class="col-md-2">
                    <div class="form-group">
                        <input type="text" class="form-control" id="fname" name="fname" placeholder="First Name" autocomplete="off">
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <input type="text" class="form-control" id="lname" name="lname" placeholder="Last name" autocomplete="off">
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <input type="text" class="form-control number_only" id="phone_number" name="phone_number" placeholder="Phone" autocomplete="off">
                    </div>
                </div>
                 <div class="col-md-2">
                    <div class="form-group">
                        <input type="text" class="form-control number_only" id="address" name="address" placeholder="Address" autocomplete="off">
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <input type="button" class="btn btn-primary btn-block btn-ds" onclick="get_searched_data()" value="Search">
                    </div>
                </div>
            </div>
        </form>
    </div>

    <table class="table table-ds" id="genericTable">
        <thead class="thead-dark">
        <tr>
            <th>Contact ID</th>
            <th>First Name</th>
            <th>Middle Name</th>
            <th>Last Name</th>
            <th>Address Type</th>
            <th>Address</th>
            <th>City</th>
            <th>State</th>
            <th>Zipcode</th>
            <th>Phone Type</th>
            <th>Area Code</th>
            <th>Number</th>
            <th>Date Type</th>
            <th>Date</th>
            <th>Actions</th>

        </tr>
        </thead>
        <tbody>

        </tbody>
    </table>

    {% block js %}
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
        <script>
            $(document).ready(function () {
                get_audience_list();
            });

             function get_searched_data () {
                table.destroy();
                get_audience_list();
            }

            function get_audience_list() {

                const first_name =  $('#fname').val();
                const last_name =  $('#lname').val();
                const phone =  $('#phone_number').val();
                const address = $('#address').val();
                const date = $('#date').val();

                let data = {'first_name': first_name, 'last_name': last_name, 'number': phone, 'address': address, 'date': date};

                table = $('#genericTable').DataTable({
                    "processing": true,
                    "serverSide": true, //temporary disabled
                    "searching": false,
                    "pagingType": "simple",
                    "lengthChange": false,
                    "pageLength": 50,
                    "order": [[ 0, "desc" ]],
                    "info": false,
                    "ajax": {"data": data, "type": "POST", "url": "{% url 'showData' %}",},
                    "columnDefs": [
                        {"orderable": false, "targets": [0,1,2,3,4,5,6,7,8,9,10,11,12,13]},
                        {"searchable": false, "targets": []}
                    ],
                    "columns": [
                        {"data": "0"},
                        {"data": "1"},
                        {"data": "2"},
                        {"data": "3"},
                        {"data": "4"},
                        {"data": "5"},
                        {"data": "6"},
                        {"data": "7"},
                        {"data": "8"},
                        {"data": "9"},
                        {"data": "10"},
                        {"data": "11"},
                        {"data": "12"},
                        {"data": "13"}
                        //{"data": "14"}
                    ]
                });
            }
        </script>
    {% endblock js %}
</body>
</html>